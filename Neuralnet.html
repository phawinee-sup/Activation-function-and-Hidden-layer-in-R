<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter03</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Neuralnet_files/libs/clipboard/clipboard.min.js"></script>
<script src="Neuralnet_files/libs/quarto-html/quarto.js"></script>
<script src="Neuralnet_files/libs/quarto-html/popper.min.js"></script>
<script src="Neuralnet_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Neuralnet_files/libs/quarto-html/anchor.min.js"></script>
<link href="Neuralnet_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Neuralnet_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Neuralnet_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Neuralnet_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Neuralnet_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter03</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ผเขยน-ภาวน-สภาวมล-67076047" class="level3">
<h3 class="anchored" data-anchor-id="ผเขยน-ภาวน-สภาวมล-67076047">ผู้เขียน: ภาวินี สุภาวิมล (67076047)</h3>
<p>วันที่ 2024-12-27</p>
<p>สถานะ: สำเร็จ</p>
</section>
<section id="check-boundary-of-numeric" class="level2">
<h2 class="anchored" data-anchor-id="check-boundary-of-numeric">Check boundary of numeric</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">1000000</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1e+06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fl">1e15</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1e+15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fl">1e318</span> <span class="co">#เยอะสุด</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fl">1e-324</span> <span class="co">#เยอะสุด</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="linear-function" class="level2">
<h2 class="anchored" data-anchor-id="linear-function">Linear function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>act.linear <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> x <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.linear</span>(a)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.4207355  0.4546487  0.0705600 -0.3784012 -0.4794621 -0.1397077
 [7]  0.3284933  0.4946791  0.2060592 -0.2720106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="unit-step-function" class="level2">
<h2 class="anchored" data-anchor-id="unit-step-function">Unit step function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>act.step <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &gt; 0.5; 1</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &lt;= 0.5 &amp; &gt;= 0.5; 0</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &lt; -0.5; -1</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> x</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x[i]<span class="sc">&gt;</span><span class="fl">0.5</span>) {out[i] <span class="ot">=</span> <span class="dv">1</span>}<span class="cf">else</span>{</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(x[i]<span class="sc">&lt;=</span><span class="fl">0.5</span> <span class="sc">&amp;</span> x[i]<span class="sc">&gt;=-</span><span class="fl">0.5</span>) {out[i] <span class="ot">=</span> <span class="dv">0</span>}<span class="cf">else</span>{</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        out[i] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>act.step2 <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &gt; 0.5; 1</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &lt;= 0.5 &amp; &gt;= 0.5; 0</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &lt; -0.5; -1</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> x</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  out[x<span class="sc">&gt;</span><span class="fl">0.5</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  out[x<span class="sc">&lt;=</span><span class="fl">0.5</span> <span class="sc">&amp;</span> x<span class="sc">&gt;=-</span><span class="fl">0.5</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  out[x<span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.5</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)<span class="sc">*</span><span class="dv">3</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.step</span>(a)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  1  0 -1 -1 -1  1  1  1 -1 -1 -1  1  1  1 -1 -1 -1  0  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.step2</span>(a)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  1  0 -1 -1 -1  1  1  1 -1 -1 -1  1  1  1 -1 -1 -1  0  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'green'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sigmoid-function" class="level2">
<h2 class="anchored" data-anchor-id="sigmoid-function">Sigmoid function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>act.sigmoid <span class="ot">=</span> <span class="cf">function</span>(x) <span class="co">#Output อยู่ซีกบวก</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> <span class="fl">1.5</span> <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>(x<span class="fl">-0.5</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.sigmoid</span>(a)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.8768217 0.9013791 0.6168461 0.3322872 0.2829479 0.4716688 0.8087494
 [8] 0.9299329 0.7170656 0.3905623</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hyperbolic-tangent" class="level2">
<h2 class="anchored" data-anchor-id="hyperbolic-tangent">Hyperbolic tangent</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>act.tanh <span class="ot">=</span> <span class="cf">function</span>(x) <span class="co">#Output อยู่ซีบวกและลบ</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> <span class="fu">tanh</span>(x)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.tanh</span>(a)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.6865874  0.7207949  0.1401906 -0.6391897 -0.7437967 -0.2723640
 [7]  0.5763545  0.7570885  0.3902700 -0.4960258</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="softmax-function" class="level2">
<h2 class="anchored" data-anchor-id="softmax-function">Softmax function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>act.softmax <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  ez <span class="ot">=</span> <span class="fu">exp</span>(x)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> ez <span class="sc">/</span> <span class="fu">sum</span>(ez)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.softmax</span>(a)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.16254595 0.17395336 0.08068961 0.03287417 0.02685805 0.05298847
 [7] 0.13516231 0.18845288 0.10580611 0.04066910</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relu-function" class="level2">
<h2 class="anchored" data-anchor-id="relu-function">ReLu function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>act.relu <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> x</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  out[x<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">sin</span>(a)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">act.relu</span>(a)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.8414710 0.9092974 0.1411200 0.0000000 0.0000000 0.0000000 0.6569866
 [8] 0.9893582 0.4121185 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="neuralnet-library" class="level2">
<h2 class="anchored" data-anchor-id="neuralnet-library">Neuralnet library</h2>
<p>Install package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.package("neuralnet")</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"neuralnet"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>??neuralnet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>starting httpd help server ... done</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>and <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>and.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, and)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(and.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 and
1    0    0   0
2    1    0   0
3    0    1   0
4    1    1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(and.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(and.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   0
2 1 0   0
3 0 1   0
4 1 1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                and.data,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">0</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = and.data, hidden = 0, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   0
3   0
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21b3d108&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba21b354f8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   0
3 0 1   0
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] -0.2561827
[2,]  0.2500632
[3,]  0.2497544
[4,]  0.7560003


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]
[1,] -0.2561827
[2,]  0.5062459
[3,]  0.5059371



$generalized.weights
$generalized.weights[[1]]
          [,1]      [,2]
[1,] -1.573109 -1.572150
[2,]  2.699523  2.697877
[3,]  2.701748  2.700100
[4,]  2.744418  2.742744


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]
[1,] -1.4646210
[2,] -0.1277174
[3,]  0.9662501



$result.matrix
                          [,1]
error              0.125037147
reached.threshold  0.006063445
steps             37.000000000
Intercept.to.OUT  -0.256182699
A.to.OUT           0.506245869
B.to.OUT           0.505937104

attr(,"class")
[1] "nn"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(net, <span class="st">"C:/Users/User/DL/net.rds"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#net2 = readRDS("D:/DL/net.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(net, datatest)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -0.2561827
[2,]  0.2500632
[3,]  0.2497544
[4,]  0.7560003
[5,]  0.2497544
[6,] -0.2561827</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>and <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>and.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, and)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(and.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 and
1    0    0   0
2    1    0   0
3    0    1   0
4    1    1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(and.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(and.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   0
2 1 0   0
3 0 1   0
4 1 1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                and.data,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">2</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = and.data, hidden = 2, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   0
3   0
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1ff97e40&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1ff9c3c8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   0
3 0 1   0
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
            [,1]
[1,] -0.01335510
[2,]  0.01836322
[3,]  0.02299761
[4,]  0.97877996


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]       [,2]
[1,]  1.529899  0.3758400
[2,] -3.928486 -2.2586229
[3,]  6.312415  0.3836771

$weights[[1]][[2]]
           [,1]
[1,]  0.1791353
[2,]  1.1809414
[3,] -1.9620076



$generalized.weights
$generalized.weights[[1]]
          [,1]       [,2]
[1,] -28.87717 -67.171679
[2,]   8.53075  26.785235
[3,]  42.74656  -7.145007
[4,]  27.55351   1.478897


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]
[1,]  1.5003894 -0.4583082
[2,] -0.6927527 -1.4958211
[3,]  0.8124151 -0.9718171

$startweights[[1]][[2]]
           [,1]
[1,] -0.1020306
[2,]  0.2637486
[3,] -1.7089325



$result.matrix
                               [,1]
error                  0.0007473733
reached.threshold      0.0072645954
steps                 56.0000000000
Intercept.to.1layhid1  1.5298987795
A.to.1layhid1         -3.9284860778
B.to.1layhid1          6.3124151003
Intercept.to.1layhid2  0.3758399992
A.to.1layhid2         -2.2586228928
B.to.1layhid2          0.3836770522
Intercept.to.OUT       0.1791353131
1layhid1.to.OUT        1.1809414242
1layhid2.to.OUT       -1.9620076312

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(net, datatest)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] -0.01335510
[2,]  0.01836322
[3,]  0.02299761
[4,]  0.97877996
[5,]  0.02299761
[6,] -0.01335510</code></pre>
</div>
</div>
</section>
<section id="การทดลอง" class="level2">
<h2 class="anchored" data-anchor-id="การทดลอง">การทดลอง</h2>
<p>จากวิธีการด้านบน เปลี่ยนเป็น OR, NOR, NAND, XOR ทดลองว่าถ้า hidden = 0 ผลลัพธ์ถูกไหม ถ้าเพิ่ม hidden มากกว่า 0 ผลลัพธ์เป็นอย่างไร</p>
<section id="or-hidden-0" class="level4">
<h4 class="anchored" data-anchor-id="or-hidden-0">OR: hidden = 0</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>or <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>or.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, or)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 or
1    0    0  0
2    1    0  1
3    0    1  1
4    1    1  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(or.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>or_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                or.data,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">0</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = or.data, hidden = 0, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1ed56258&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1ed55dc0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
          [,1]
[1,] 0.2478835
[2,] 0.7522984
[3,] 0.7439589
[4,] 1.2483739


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]
[1,] 0.2478835
[2,] 0.5044150
[3,] 0.4960754



$generalized.weights
$generalized.weights[[1]]
          [,1]      [,2]
[1,]  2.705548  2.660817
[2,]  2.706880  2.662127
[3,]  2.648069  2.604288
[4,] -1.626812 -1.599916


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
          [,1]
[1,] -1.068367
[2,]  0.822815
[3,] -1.753925



$result.matrix
                          [,1]
error              0.125024451
reached.threshold  0.007667253
steps             26.000000000
Intercept.to.OUT   0.247883490
A.to.OUT           0.504414954
B.to.OUT           0.496075407

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(or_net, datatest)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.2478835
[2,] 0.7522984
[3,] 0.7439589
[4,] 1.2483739
[5,] 0.7439589
[6,] 0.2478835</code></pre>
</div>
</div>
</section>
<section id="or-hidden-1" class="level4">
<h4 class="anchored" data-anchor-id="or-hidden-1">OR: hidden = 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>or_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                or.data,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">1</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = or.data, hidden = 1, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba2118e4e0&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba2118e978&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
            [,1]
[1,] -0.00518267
[2,]  0.99053560
[3,]  0.97460548
[4,]  1.04189258


$weights
$weights[[1]]
$weights[[1]][[1]]
            [,1]
[1,]  0.05658167
[2,] -3.67753751
[3,] -3.40739803

$weights[[1]][[2]]
          [,1]
[1,]  1.043699
[2,] -2.040064



$generalized.weights
$generalized.weights[[1]]
             [,1]         [,2]
[1,] -359.7450409 -333.3193863
[2,]   20.3114668   18.8194551
[3,]    9.9189016    9.1902926
[4,]   -0.1520884   -0.1409165


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
          [,1]
[1,] -1.133249
[2,]  2.022462
[3,] -0.639326

$startweights[[1]][[2]]
          [,1]
[1,] 2.3706678
[2,] 0.3238191



$result.matrix
                              [,1]
error                  0.001258153
reached.threshold      0.004750738
steps                 70.000000000
Intercept.to.1layhid1  0.056581670
A.to.1layhid1         -3.677537507
B.to.1layhid1         -3.407398035
Intercept.to.OUT       1.043699275
1layhid1.to.OUT       -2.040064165

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(or_net, datatest)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] -0.00518267
[2,]  0.99053560
[3,]  0.97460548
[4,]  1.04189258
[5,]  0.97460548
[6,] -0.00518267</code></pre>
</div>
</div>
</section>
<section id="or-hidden-2" class="level4">
<h4 class="anchored" data-anchor-id="or-hidden-2">OR: hidden = 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>or_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                or.data,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">2</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = or.data, hidden = 2, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba22757710&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba22757be0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 0.02510334
[2,] 0.96097586
[3,] 0.95492675
[4,] 1.06221272


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]       [,2]
[1,] -0.789509 -0.4511567
[2,]  3.318198  3.3422407
[3,]  3.139561  3.7569355

$weights[[1]][[2]]
           [,1]
[1,] -0.5015420
[2,]  1.0869114
[3,]  0.4812076



$generalized.weights
$generalized.weights[[1]]
           [,1]       [,2]
[1,] 47.2697219 47.5040789
[2,]  8.7166112  8.6275536
[3,]  7.9350476  7.7347023
[4,] -0.2186808 -0.2125077


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]      [,2]
[1,] -0.7441117 0.7580831
[2,]  0.8859422 0.6363636
[3,] -0.6604387 0.2885355

$startweights[[1]][[2]]
            [,1]
[1,] -0.08372968
[2,]  0.13949511
[3,] -0.08604447



$result.matrix
                              [,1]
error                  0.004027540
reached.threshold      0.008550962
steps                 39.000000000
Intercept.to.1layhid1 -0.789509018
A.to.1layhid1          3.318198463
B.to.1layhid1          3.139561322
Intercept.to.1layhid2 -0.451156743
A.to.1layhid2          3.342240745
B.to.1layhid2          3.756935495
Intercept.to.OUT      -0.501541957
1layhid1.to.OUT        1.086911392
1layhid2.to.OUT        0.481207565

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(or_net, datatest)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.02510334
[2,] 0.96097586
[3,] 0.95492675
[4,] 1.06221272
[5,] 0.95492675
[6,] 0.02510334</code></pre>
</div>
</div>
</section>
<section id="or-hidden-3" class="level4">
<h4 class="anchored" data-anchor-id="or-hidden-3">OR: hidden = 3</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>or_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                or.data,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">3</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = or.data, hidden = 3, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1ff05eb0&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1ff02438&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
          [,1]
[1,] 0.0157388
[2,] 0.9661852
[3,] 0.9646067
[4,] 1.0622868


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]       [,2]       [,3]
[1,]  1.050405 -0.5565118  0.0521223
[2,] -1.540019 -4.2514785 -0.9407690
[3,] -1.371330 -4.2397508 -0.8595495

$weights[[1]][[2]]
           [,1]
[1,]  1.2274271
[2,]  0.7041744
[3,] -2.2917291
[4,] -1.7511240



$generalized.weights
$generalized.weights[[1]]
           [,1]       [,2]
[1,] 158.794924 157.571573
[2,]   4.986962   4.938076
[3,]   4.871657   4.824476
[4,]  -1.252632  -1.190233


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]        [,2]       [,3]
[1,]  1.2695875 -0.80904400 -0.1193903
[2,] -0.8520411 -0.08962222 -0.6546455
[3,] -0.7482118  0.39772627  0.9044831

$startweights[[1]][[2]]
          [,1]
[1,]  1.553720
[2,]  1.155497
[3,] -1.177401
[4,] -1.332684



$result.matrix
                              [,1]
error                  0.003261746
reached.threshold      0.008817481
steps                 55.000000000
Intercept.to.1layhid1  1.050405016
A.to.1layhid1         -1.540018862
B.to.1layhid1         -1.371329921
Intercept.to.1layhid2 -0.556511790
A.to.1layhid2         -4.251478496
B.to.1layhid2         -4.239750849
Intercept.to.1layhid3  0.052122300
A.to.1layhid3         -0.940768978
B.to.1layhid3         -0.859549462
Intercept.to.OUT       1.227427112
1layhid1.to.OUT        0.704174411
1layhid2.to.OUT       -2.291729050
1layhid3.to.OUT       -1.751123984

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(or_net, datatest)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.0157388
[2,] 0.9661852
[3,] 0.9646067
[4,] 1.0622868
[5,] 0.9646067
[6,] 0.0157388</code></pre>
</div>
</div>
</section>
<section id="or-hidden-4" class="level4">
<h4 class="anchored" data-anchor-id="or-hidden-4">OR: hidden = 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>or_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                or.data,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">4</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = or.data, hidden = 4, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   1

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba228a28b8&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba228a2d50&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   1

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 0.01088057
[2,] 0.99005558
[3,] 0.98370693
[4,] 1.02440013


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]        [,2]       [,3]      [,4]
[1,] -0.0630573  0.01517811 -0.6589064 -2.159705
[2,]  2.5299420  0.21210629  3.4209219  1.767234
[3,]  3.5379801 -0.25652676  4.1566661 -1.736508

$weights[[1]][[2]]
           [,1]
[1,] -0.2905478
[2,]  0.8247221
[3,] -0.8840833
[4,]  0.8799826
[5,]  0.4582838



$generalized.weights
$generalized.weights[[1]]
           [,1]       [,2]
[1,] 113.898850 142.498477
[2,]  47.457507  28.363667
[3,]   7.251366  14.328161
[4,]  -1.527126   0.326112


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]       [,3]       [,4]
[1,]  0.5413383 -0.3953649  0.5644979 -2.0590339
[2,] -0.7943351  0.5471500 -0.3342781  1.1166855
[3,]  0.4939238  0.3676680  0.4494098  0.1373925

$startweights[[1]][[2]]
           [,1]
[1,]  0.1199952
[2,]  1.0984082
[3,] -0.4735403
[4,]  1.1265149
[5,]  0.5441121



$result.matrix
                               [,1]
error                  0.0005390543
reached.threshold      0.0090432165
steps                 51.0000000000
Intercept.to.1layhid1 -0.0630573000
A.to.1layhid1          2.5299420270
B.to.1layhid1          3.5379800831
Intercept.to.1layhid2  0.0151781051
A.to.1layhid2          0.2121062868
B.to.1layhid2         -0.2565267570
Intercept.to.1layhid3 -0.6589064350
A.to.1layhid3          3.4209218898
B.to.1layhid3          4.1566661087
Intercept.to.1layhid4 -2.1597052229
A.to.1layhid4          1.7672342042
B.to.1layhid4         -1.7365081225
Intercept.to.OUT      -0.2905477636
1layhid1.to.OUT        0.8247221223
1layhid2.to.OUT       -0.8840832721
1layhid3.to.OUT        0.8799825708
1layhid4.to.OUT        0.4582837847

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(or_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pred4 <span class="ot">=</span> <span class="fu">predict</span>(or_net, datatest)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.01088057
[2,] 0.99005558
[3,] 0.98370693
[4,] 1.02440013
[5,] 0.98370693
[6,] 0.01088057</code></pre>
</div>
</div>
<p>Compare result between set hidden = 0, 1, 2, 3 and 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>compare.or <span class="ot">=</span> <span class="fu">data.frame</span>(A, B, actual, pred, pred1, pred2, pred3, pred4)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(compare.or) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"Actual"</span>, <span class="st">"OUT(0)"</span>, <span class="st">"OUT(1)"</span>, <span class="st">"OUT(2)"</span>, <span class="st">"OUT(3)"</span>, <span class="st">"OUT(4)"</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)      OUT(1)     OUT(2)    OUT(3)     OUT(4)
1 0 0      0 0.2478835 -0.00518267 0.02510334 0.0157388 0.01088057
2 1 0      1 0.7522984  0.99053560 0.96097586 0.9661852 0.99005558
3 0 1      1 0.7439589  0.97460548 0.95492675 0.9646067 0.98370693
4 1 1      1 1.2483739  1.04189258 1.06221272 1.0622868 1.02440013
5 0 1      1 0.7439589  0.97460548 0.95492675 0.9646067 0.98370693
6 0 0      0 0.2478835 -0.00518267 0.02510334 0.0157388 0.01088057</code></pre>
</div>
</div>
</section>
<section id="nor-hidden-0" class="level4">
<h4 class="anchored" data-anchor-id="nor-hidden-0">NOR: hidden = 0</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>nor <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>nor.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, nor)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 nor
1    0    0   1
2    1    0   0
3    0    1   0
4    1    1   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(nor.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>nor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                nor.data,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">0</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nor.data, hidden = 0, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   0
3   0
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21f9db30&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba21fa20b8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,]  0.7426990
[2,]  0.2501569
[3,]  0.2486062
[4,] -0.2439359


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]
[1,]  0.7426990
[2,] -0.4925421
[3,] -0.4940928



$generalized.weights
$generalized.weights[[1]]
          [,1]      [,2]
[1,] -2.577443 -2.585558
[2,] -2.625793 -2.634060
[3,] -2.636718 -2.645020
[4,]  1.623191  1.628302


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]
[1,] -0.5737561
[2,] -1.7184468
[3,]  0.2782156



$result.matrix
                         [,1]
error              0.12504602
reached.threshold  0.00622107
steps             58.00000000
Intercept.to.OUT   0.74269902
A.to.OUT          -0.49254209
B.to.OUT          -0.49409279

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(nor_net, datatest)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,]  0.7426990
[2,]  0.2501569
[3,]  0.2486062
[4,] -0.2439359
[5,]  0.2486062
[6,]  0.7426990</code></pre>
</div>
</div>
</section>
<section id="nor-hidden-1" class="level4">
<h4 class="anchored" data-anchor-id="nor-hidden-1">NOR: hidden = 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>nor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                nor.data,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">1</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nor.data, hidden = 1, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   0
3   0
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1ab58d80&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1ab588e8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
            [,1]
[1,]  1.00246621
[2,]  0.01745319
[3,]  0.01790495
[4,] -0.03190816


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]
[1,]  0.7616342
[2,] -4.1375729
[3,] -4.1283058

$weights[[1]][[2]]
            [,1]
[1,] -0.03274403
[2,]  1.51855281



$generalized.weights
$generalized.weights[[1]]
           [,1]        [,2]
[1,] 551.440851 550.2057688
[2,] -11.711123 -11.6848929
[3,] -11.520131 -11.4943292
[4,]   0.104979   0.1047439


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]
[1,]  2.2317721
[2,] -0.2323729
[3,] -0.2231058

$startweights[[1]][[2]]
           [,1]
[1,] -0.6695840
[2,]  0.8333025



$result.matrix
                              [,1]
error                  0.000824707
reached.threshold      0.005916197
steps                 50.000000000
Intercept.to.1layhid1  0.761634160
A.to.1layhid1         -4.137572864
B.to.1layhid1         -4.128305789
Intercept.to.OUT      -0.032744029
1layhid1.to.OUT        1.518552813

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(nor_net, datatest)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,]  1.00246621
[2,]  0.01745319
[3,]  0.01790495
[4,] -0.03190816
[5,]  0.01790495
[6,]  1.00246621</code></pre>
</div>
</div>
</section>
<section id="nor-hidden-2" class="level4">
<h4 class="anchored" data-anchor-id="nor-hidden-2">NOR: hidden = 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>nor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                nor.data,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">2</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nor.data, hidden = 2, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   0
3   0
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21a43a58&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba21a43ef0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
            [,1]
[1,]  0.97901577
[2,]  0.07448067
[3,]  0.02418218
[4,] -0.08750991


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]       [,2]
[1,] 0.6959603 -0.5401454
[2,] 1.7862436 -2.2687035
[3,] 1.8952438 -2.6790102

$weights[[1]][[2]]
           [,1]
[1,]  0.3068096
[2,] -0.4099874
[3,]  2.5690007



$generalized.weights
$generalized.weights[[1]]
            [,1]        [,2]
[1,] -73.9075101 -86.3256808
[2,]  -5.2893245  -6.1553223
[3,] -11.1443760 -12.9187271
[4,]   0.3455071   0.3966997


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
          [,1]       [,2]
[1,] 1.4268287 -1.0885454
[2,] 0.5178436  0.5312965
[3,] 1.2768438 -0.2106102

$startweights[[1]][[2]]
          [,1]
[1,] 1.0927596
[2,] 0.6959562
[3,] 2.0206007



$result.matrix
                              [,1]
error                  0.007115236
reached.threshold      0.009831291
steps                 29.000000000
Intercept.to.1layhid1  0.695960330
A.to.1layhid1          1.786243606
B.to.1layhid1          1.895243787
Intercept.to.1layhid2 -0.540145362
A.to.1layhid2         -2.268703455
B.to.1layhid2         -2.679010235
Intercept.to.OUT       0.306809620
1layhid1.to.OUT       -0.409987432
1layhid2.to.OUT        2.569000684

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(nor_net, datatest)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,]  0.97901577
[2,]  0.07448067
[3,]  0.02418218
[4,] -0.08750991
[5,]  0.02418218
[6,]  0.97901577</code></pre>
</div>
</div>
</section>
<section id="nor-hidden-3" class="level4">
<h4 class="anchored" data-anchor-id="nor-hidden-3">NOR: hidden = 3</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>nor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                nor.data,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">3</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nor.data, hidden = 3, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   0
3   0
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1db09d80&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1db098e8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
              [,1]
[1,]  0.9897716231
[2,] -0.0007248956
[3,]  0.0207351759
[4,] -0.0144633003


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]      [,2]       [,3]
[1,] -1.980503 -1.215196  1.6864838
[2,]  2.625746  4.949011  0.1414834
[3,] -3.054755  4.665656 -1.5036138

$weights[[1]][[2]]
           [,1]
[1,]  0.5821487
[2,] -0.4231108
[3,] -1.0415463
[4,]  0.8263234



$generalized.weights
$generalized.weights[[1]]
            [,1]      [,2]
[1,] -100.008613 -87.26804
[2,]  488.406635 -45.04231
[3,]   -6.491136 -21.89557
[4,]    3.866766  14.03318


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
            [,1]       [,2]       [,3]
[1,] -0.05389748 -0.4518163 -0.6091702
[2,] -0.07807952  0.8122114  1.0400759
[3,] -1.11067797  0.1972564 -0.4859335

$startweights[[1]][[2]]
           [,1]
[1,] -0.1182139
[2,] -1.9570010
[3,] -0.9574719
[4,]  0.1297565



$result.matrix
                               [,1]
error                  0.0003721399
reached.threshold      0.0063361838
steps                 55.0000000000
Intercept.to.1layhid1 -1.9805034693
A.to.1layhid1          2.6257464023
B.to.1layhid1         -3.0547550884
Intercept.to.1layhid2 -1.2151956238
A.to.1layhid2          4.9490114149
B.to.1layhid2          4.6656564403
Intercept.to.1layhid3  1.6864837797
A.to.1layhid3          0.1414833681
B.to.1layhid3         -1.5036138321
Intercept.to.OUT       0.5821487257
1layhid1.to.OUT       -0.4231108025
1layhid2.to.OUT       -1.0415463013
1layhid3.to.OUT        0.8263234240

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(nor_net, datatest)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,]  0.9897716231
[2,] -0.0007248956
[3,]  0.0207351759
[4,] -0.0144633003
[5,]  0.0207351759
[6,]  0.9897716231</code></pre>
</div>
</div>
</section>
<section id="nor-hidden-4" class="level4">
<h4 class="anchored" data-anchor-id="nor-hidden-4">NOR: hidden = 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>nor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                nor.data,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">4</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nor.data, hidden = 4, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   0
3   0
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21c7ebf8&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba21c7b180&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   0
3 0 1   0
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
             [,1]
[1,]  0.992389135
[2,]  0.005861403
[3,]  0.010004380
[4,] -0.015318621


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]       [,2]      [,3]        [,4]
[1,]  0.1718135  0.7366083  1.676131 -0.07929114
[2,] -1.3760889  0.1252491 -1.917484 -2.57203029
[3,] -2.3215855 -1.2220821  4.228122  0.16374113

$weights[[1]][[2]]
           [,1]
[1,] -1.4543103
[2,]  2.1529271
[3,]  0.6856034
[4,]  1.1398012
[5,] -0.3036596



$generalized.weights
$generalized.weights[[1]]
            [,1]       [,2]
[1,] -107.459851 -105.44034
[2,] -171.325240   20.99427
[3,]   -6.832011  -67.04915
[4,]    2.909142   16.64702


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]       [,3]       [,4]
[1,] -0.7364597  0.4257421  1.2208386  0.9649228
[2,] -0.6472239  0.3032379 -1.4875500 -0.9682670
[3,] -1.9746629 -1.7784120 -0.2077553  0.6824003

$startweights[[1]][[2]]
           [,1]
[1,] -2.3862270
[2,]  1.2338620
[3,] -0.2352672
[4,] -0.1225581
[5,] -1.6411705



$result.matrix
                               [,1]
error                  0.0002135145
reached.threshold      0.0088949167
steps                 58.0000000000
Intercept.to.1layhid1  0.1718135418
A.to.1layhid1         -1.3760889124
B.to.1layhid1         -2.3215855475
Intercept.to.1layhid2  0.7366083229
A.to.1layhid2          0.1252491175
B.to.1layhid2         -1.2220821450
Intercept.to.1layhid3  1.6761306201
A.to.1layhid3         -1.9174835565
B.to.1layhid3          4.2281218421
Intercept.to.1layhid4 -0.0792911430
A.to.1layhid4         -2.5720302950
B.to.1layhid4          0.1637411342
Intercept.to.OUT      -1.4543102641
1layhid1.to.OUT        2.1529271409
1layhid2.to.OUT        0.6856034035
1layhid3.to.OUT        1.1398012185
1layhid4.to.OUT       -0.3036595901

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>pred4 <span class="ot">=</span> <span class="fu">predict</span>(nor_net, datatest)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]
[1,]  0.992389135
[2,]  0.005861403
[3,]  0.010004380
[4,] -0.015318621
[5,]  0.010004380
[6,]  0.992389135</code></pre>
</div>
</div>
<p>Compare result between set hidden = 1,2,3 and 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>compare.nor <span class="ot">=</span> <span class="fu">data.frame</span>(A, B, actual, pred, pred1, pred2, pred3, pred4)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(compare.nor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"Actual"</span>, <span class="st">"OUT(0)"</span>, <span class="st">"OUT(1)"</span>, <span class="st">"OUT(2)"</span>, <span class="st">"OUT(3)"</span>, <span class="st">"OUT(4)"</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.nor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual     OUT(0)      OUT(1)      OUT(2)        OUT(3)       OUT(4)
1 0 0      1  0.7426990  1.00246621  0.97901577  0.9897716231  0.992389135
2 1 0      0  0.2501569  0.01745319  0.07448067 -0.0007248956  0.005861403
3 0 1      0  0.2486062  0.01790495  0.02418218  0.0207351759  0.010004380
4 1 1      0 -0.2439359 -0.03190816 -0.08750991 -0.0144633003 -0.015318621
5 0 1      0  0.2486062  0.01790495  0.02418218  0.0207351759  0.010004380
6 0 0      1  0.7426990  1.00246621  0.97901577  0.9897716231  0.992389135</code></pre>
</div>
</div>
</section>
<section id="nand-hidden-0" class="level4">
<h4 class="anchored" data-anchor-id="nand-hidden-0">NAND: hidden = 0</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>nand <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>nand.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, nand)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 nand
1    0    0    1
2    1    0    1
3    0    1    1
4    1    1    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(nand.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>nand_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                nand.data,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">0</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nand.data, hidden = 0, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21604148&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba216045e0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
          [,1]
[1,] 1.2427502
[2,] 0.7480254
[3,] 0.7497326
[4,] 0.2550078


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]
[1,]  1.2427502
[2,] -0.4947248
[3,] -0.4930176



$generalized.weights
$generalized.weights[[1]]
          [,1]      [,2]
[1,]  1.639911  1.634252
[2,] -2.624766 -2.615709
[3,] -2.636653 -2.627555
[4,] -2.604105 -2.595119


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
             [,1]
[1,] -2.117714234
[2,]  0.249223959
[3,] -0.001177672



$result.matrix
                         [,1]
error              0.12504080
reached.threshold  0.00474043
steps             56.00000000
Intercept.to.OUT   1.24275022
A.to.OUT          -0.49472480
B.to.OUT          -0.49301761

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(nand_net, datatest)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 1.2427502
[2,] 0.7480254
[3,] 0.7497326
[4,] 0.2550078
[5,] 0.7497326
[6,] 1.2427502</code></pre>
</div>
</div>
</section>
<section id="nand-hidden-1" class="level4">
<h4 class="anchored" data-anchor-id="nand-hidden-1">NAND: hidden = 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>nand_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                nand.data,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">1</span>,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nand.data, hidden = 1, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1f00ec70&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1f00e768&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
          [,1]
[1,] 0.7413312
[2,] 0.7497864
[3,] 0.7497323
[4,] 0.7498027


$weights
$weights[[1]]
$weights[[1]][[1]]
         [,1]
[1,] 3.080333
[2,] 6.288071
[3,] 4.832656

$weights[[1]][[2]]
          [,1]
[1,] 0.5569391
[2,] 0.1928638



$generalized.weights
$generalized.weights[[1]]
             [,1]         [,2]
[1,] 2.655972e-01 2.041230e-01
[2,] 5.518223e-04 4.240994e-04
[3,] 2.363589e-03 1.816521e-03
[4,] 4.396386e-06 3.378814e-06


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]
[1,] -0.9196672
[2,]  2.6196715
[3,]  0.8326562

$startweights[[1]][[2]]
            [,1]
[1,] -0.23556790
[2,]  0.00544796



$result.matrix
                              [,1]
error                  0.377177235
reached.threshold      0.009347356
steps                 41.000000000
Intercept.to.1layhid1  3.080332809
A.to.1layhid1          6.288071457
B.to.1layhid1          4.832656171
Intercept.to.OUT       0.556939091
1layhid1.to.OUT        0.192863784

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(nand_net, datatest)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.7413312
[2,] 0.7497864
[3,] 0.7497323
[4,] 0.7498027
[5,] 0.7497323
[6,] 0.7413312</code></pre>
</div>
</div>
</section>
<section id="nand-hidden-2" class="level4">
<h4 class="anchored" data-anchor-id="nand-hidden-2">NAND: hidden = 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>nand_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>                nand.data,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">2</span>,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nand.data, hidden = 2, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba2113b510&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba2113b9e0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 1.06431898
[2,] 0.98071974
[3,] 0.92881016
[4,] 0.02104608


$weights
$weights[[1]]
$weights[[1]][[1]]
          [,1]      [,2]
[1,]  3.335826  2.704911
[2,] -2.970048 -4.404090
[3,] -1.057446  5.558804

$weights[[1]][[2]]
           [,1]
[1,]  0.1346079
[2,]  1.6066817
[3,] -0.6633423



$generalized.weights
$generalized.weights[[1]]
            [,1]       [,2]
[1,]  -0.1943952   3.988363
[2,] -40.8376498 -47.212360
[3,]  -6.0719717  -2.180260
[4,] -48.6281785 -21.951841


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]
[1,] -0.4373828  1.6064984
[2,] -0.5187087 -0.3911325
[3,] -0.8934066  1.2529265

$startweights[[1]][[2]]
           [,1]
[1,]  0.2536912
[2,]  0.5318869
[3,] -0.1743646



$result.matrix
                              [,1]
error                  0.005009795
reached.threshold      0.006826911
steps                 73.000000000
Intercept.to.1layhid1  3.335825811
A.to.1layhid1         -2.970048464
B.to.1layhid1         -1.057446397
Intercept.to.1layhid2  2.704911070
A.to.1layhid2         -4.404089904
B.to.1layhid2          5.558803650
Intercept.to.OUT       0.134607944
1layhid1.to.OUT        1.606681659
1layhid2.to.OUT       -0.663342268

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(nand_net, datatest)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 1.06431898
[2,] 0.98071974
[3,] 0.92881016
[4,] 0.02104608
[5,] 0.92881016
[6,] 1.06431898</code></pre>
</div>
</div>
</section>
<section id="nand-hidden-3" class="level4">
<h4 class="anchored" data-anchor-id="nand-hidden-3">NAND: hidden = 3</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>nand_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                nand.data,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">3</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nand.data, hidden = 3, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba229b8fb8&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba229b9450&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 1.01895758
[2,] 0.99177415
[3,] 0.98281331
[4,] 0.01175725


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]       [,2]      [,3]
[1,] -0.1194335  0.3115204 -1.023770
[2,] -2.0828653 -1.3768204  2.186522
[3,]  0.7907997  0.3342462 -4.245385

$weights[[1]][[2]]
           [,1]
[1,] -0.5969578
[2,]  1.8395884
[3,]  0.5392750
[4,]  1.6636160



$generalized.weights
$generalized.weights[[1]]
          [,1]        [,2]
[1,]  22.17711   50.054830
[2,]  21.45524 -136.884298
[3,] -59.59210   19.553495
[4,] -52.86387   -2.341212


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
            [,1]        [,2]       [,3]
[1,] -0.33593787  0.06253614 -0.7463427
[2,] -1.12930766 -1.36305604  0.1713583
[3,]  0.01815311 -0.34306630 -0.6519846

$startweights[[1]][[2]]
           [,1]
[1,] -0.8146357
[2,]  1.5710049
[3,]  0.2755515
[4,]  1.0983091



$result.matrix
                               [,1]
error                  0.0004303349
reached.threshold      0.0053022902
steps                 47.0000000000
Intercept.to.1layhid1 -0.1194335169
A.to.1layhid1         -2.0828652592
B.to.1layhid1          0.7907997252
Intercept.to.1layhid2  0.3115204267
A.to.1layhid2         -1.3768204378
B.to.1layhid2          0.3342462115
Intercept.to.1layhid3 -1.0237702604
A.to.1layhid3          2.1865216128
B.to.1layhid3         -4.2453846294
Intercept.to.OUT      -0.5969577751
1layhid1.to.OUT        1.8395884092
1layhid2.to.OUT        0.5392750311
1layhid3.to.OUT        1.6636160288

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(nand_net, datatest)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 1.01895758
[2,] 0.99177415
[3,] 0.98281331
[4,] 0.01175725
[5,] 0.98281331
[6,] 1.01895758</code></pre>
</div>
</div>
</section>
<section id="nand-hidden-4" class="level4">
<h4 class="anchored" data-anchor-id="nand-hidden-4">NAND: hidden = 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>nand_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>                nand.data,</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">4</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = nand.data, hidden = 4, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   1
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba214a3938&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba214a3dd0&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   1
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 1.00188348
[2,] 0.98908795
[3,] 0.97921854
[4,] 0.02652307


$weights
$weights[[1]]
$weights[[1]][[1]]
            [,1]       [,2]       [,3]       [,4]
[1,]  0.38973176  0.6595916  0.8559143 -0.3775581
[2,] -0.05390905 -1.0715504 -1.5736224 -7.0151439
[3,]  2.20226479 -0.5286445 -0.8326874 -6.4321320

$weights[[1]][[2]]
           [,1]
[1,]  0.4208174
[2,] -1.5015623
[3,]  3.3154002
[4,]  0.3794599
[5,] -2.3982104



$generalized.weights
$generalized.weights[[1]]
            [,1]        [,2]
[1,] -1672.42730 -1306.91300
[2,]   -88.30610  -118.97279
[3,]   -49.62546   -35.01757
[4,]   -30.91193   -24.16672


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
          [,1]       [,2]       [,3]       [,4]
[1,] 0.9276456 -0.1752738  0.4224562 -0.7110968
[2,] 1.1698291 -1.6093868  1.3199340  0.1532561
[3,] 0.7575559 -0.6189516 -0.8469984 -0.7856187

$startweights[[1]][[2]]
            [,1]
[1,]  0.09606266
[2,] -1.81305983
[3,]  2.77748637
[4,]  0.07366730
[5,] -1.24361854



$result.matrix
                               [,1]
error                  0.0006289813
reached.threshold      0.0090863682
steps                 76.0000000000
Intercept.to.1layhid1  0.3897317634
A.to.1layhid1         -0.0539090467
B.to.1layhid1          2.2022647933
Intercept.to.1layhid2  0.6595916334
A.to.1layhid2         -1.0715504065
B.to.1layhid2         -0.5286445101
Intercept.to.1layhid3  0.8559142923
A.to.1layhid3         -1.5736224018
B.to.1layhid3         -0.8326873972
Intercept.to.1layhid4 -0.3775581487
A.to.1layhid4         -7.0151438806
B.to.1layhid4         -6.4321320339
Intercept.to.OUT       0.4208174218
1layhid1.to.OUT       -1.5015623136
1layhid2.to.OUT        3.3154002009
1layhid3.to.OUT        0.3794598948
1layhid4.to.OUT       -2.3982104254

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nand_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>pred4 <span class="ot">=</span> <span class="fu">predict</span>(nand_net, datatest)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 1.00188348
[2,] 0.98908795
[3,] 0.97921854
[4,] 0.02652307
[5,] 0.97921854
[6,] 1.00188348</code></pre>
</div>
</div>
<p>Compare between hidden = 1,2,3 and 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>compare.nand <span class="ot">=</span> <span class="fu">data.frame</span>(A, B, actual, pred, pred1, pred2, pred3, pred4)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(compare.nand) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"Actual"</span>, <span class="st">"OUT(0)"</span>, <span class="st">"OUT(1)"</span>, <span class="st">"OUT(2)"</span>, <span class="st">"OUT(3)"</span>, <span class="st">"OUT(4)"</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.nand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)    OUT(1)     OUT(2)     OUT(3)     OUT(4)
1 0 0      1 1.2427502 0.7413312 1.06431898 1.01895758 1.00188348
2 1 0      1 0.7480254 0.7497864 0.98071974 0.99177415 0.98908795
3 0 1      1 0.7497326 0.7497323 0.92881016 0.98281331 0.97921854
4 1 1      0 0.2550078 0.7498027 0.02104608 0.01175725 0.02652307
5 0 1      1 0.7497326 0.7497323 0.92881016 0.98281331 0.97921854
6 0 0      1 1.2427502 0.7413312 1.06431898 1.01895758 1.00188348</code></pre>
</div>
</div>
</section>
<section id="xor-hidden-0" class="level4">
<h4 class="anchored" data-anchor-id="xor-hidden-0">XOR: hidden = 0</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>xor <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>truthtable <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>xor.data <span class="ot">=</span> <span class="fu">data.frame</span>(truthtable, xor)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 xor
1    0    0   0
2    1    0   1
3    0    1   1
4    1    1   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Edit column name</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xor.data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"OUT"</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>xor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>                xor.data,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">0</span>,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = xor.data, hidden = 0, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1ff61940&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1ff61dd8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
          [,1]
[1,] 0.5078420
[2,] 0.4974202
[3,] 0.5063293
[4,] 0.4959076


$weights
$weights[[1]]
$weights[[1]][[1]]
             [,1]
[1,]  0.507841979
[2,] -0.010421789
[3,] -0.001512639



$generalized.weights
$generalized.weights[[1]]
            [,1]         [,2]
[1,] -0.04169741 -0.006052045
[2,] -0.04168827 -0.006050718
[3,] -0.04169384 -0.006051526
[4,] -0.04168995 -0.006050962


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]
[1,]  0.1084170
[2,] -0.5699578
[3,] -0.4009376



$result.matrix
                          [,1]
error              0.500062480
reached.threshold  0.007499060
steps             21.000000000
Intercept.to.OUT   0.507841979
A.to.OUT          -0.010421789
B.to.OUT          -0.001512639

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>datatest <span class="ot">=</span> <span class="fu">data.frame</span>(A,B)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(xor_net, datatest)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.5078420
[2,] 0.4974202
[3,] 0.5063293
[4,] 0.4959076
[5,] 0.5063293
[6,] 0.5078420</code></pre>
</div>
</div>
</section>
<section id="xor-hidden-1" class="level4">
<h4 class="anchored" data-anchor-id="xor-hidden-1">XOR: hidden = 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>xor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                xor.data,</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">1</span>,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = xor.data, hidden = 1, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba22291d80&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba2228e308&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 0.04007883
[2,] 0.64932304
[3,] 0.65018052
[4,] 0.66813186


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]
[1,] -0.2036434
[2,] -4.0749542
[3,] -4.1214514

$weights[[1]][[2]]
           [,1]
[1,]  0.6684463
[2,] -1.3986585



$generalized.weights
$generalized.weights[[1]]
             [,1]         [,2]
[1,] 36.654639301 37.072886515
[2,]  0.337549377  0.341400979
[3,]  0.322978529  0.326663871
[4,]  0.005777188  0.005843109


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
            [,1]
[1,]  1.17045665
[2,] -0.07495418
[3,] -0.12145139

$startweights[[1]][[2]]
          [,1]
[1,] -1.555556
[2,] -2.050259



$result.matrix
                              [,1]
error                  0.346677245
reached.threshold      0.008793076
steps                 41.000000000
Intercept.to.1layhid1 -0.203643354
A.to.1layhid1         -4.074954183
B.to.1layhid1         -4.121451386
Intercept.to.OUT       0.668446282
1layhid1.to.OUT       -1.398658522

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(xor_net, datatest)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.04007883
[2,] 0.64932304
[3,] 0.65018052
[4,] 0.66813186
[5,] 0.65018052
[6,] 0.04007883</code></pre>
</div>
</div>
</section>
<section id="xor-hidden-2" class="level4">
<h4 class="anchored" data-anchor-id="xor-hidden-2">XOR: hidden = 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>xor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>                xor.data,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">2</span>,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = xor.data, hidden = 2, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1f7c0810&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1f7c0ca8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 0.03955794
[2,] 0.64285386
[3,] 0.65178590
[4,] 0.67507720


$weights
$weights[[1]]
$weights[[1]][[1]]
         [,1]       [,2]
[1,] 1.412791 -0.8095082
[2,] 3.149843 -3.3104787
[3,] 3.749755 -3.5660970

$weights[[1]][[2]]
            [,1]
[1,]  0.01148481
[2,]  0.66450997
[3,] -1.64395236



$generalized.weights
$generalized.weights[[1]]
            [,1]        [,2]
[1,] 39.20477309 43.21430857
[2,]  0.46602577  0.51256104
[3,]  0.34643464  0.37909777
[4,]  0.01372323  0.01504798


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
            [,1]       [,2]
[1,]  1.67895415  0.4943589
[2,] -0.03103372 -0.3157224
[3,]  0.11295503  0.4023030

$startweights[[1]][[2]]
           [,1]
[1,] -0.6502919
[2,] -0.0102624
[3,] -1.6199650



$result.matrix
                              [,1]
error                  0.353050238
reached.threshold      0.009274902
steps                 44.000000000
Intercept.to.1layhid1  1.412790842
A.to.1layhid1          3.149843401
B.to.1layhid1          3.749755030
Intercept.to.1layhid2 -0.809508179
A.to.1layhid2         -3.310478669
B.to.1layhid2         -3.566096979
Intercept.to.OUT       0.011484808
1layhid1.to.OUT        0.664509971
1layhid2.to.OUT       -1.643952357

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(xor_net, datatest)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.03955794
[2,] 0.64285386
[3,] 0.65178590
[4,] 0.67507720
[5,] 0.65178590
[6,] 0.03955794</code></pre>
</div>
</div>
</section>
<section id="xor-hidden-3" class="level4">
<h4 class="anchored" data-anchor-id="xor-hidden-3">XOR: hidden = 3</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>xor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>                xor.data,</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">3</span>,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = xor.data, hidden = 3, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba21f09820&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba21f09cb8&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
            [,1]
[1,] 0.001610854
[2,] 0.992074310
[3,] 0.989910767
[4,] 0.018303839


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]       [,2]      [,3]
[1,] -0.9453595 -0.7897019 -1.721361
[2,] -3.6938464 -3.4288497  2.392052
[3,]  1.5470049 -4.0153143 -5.739544

$weights[[1]][[2]]
            [,1]
[1,] -0.06310196
[2,]  1.65443604
[3,] -2.06054101
[4,]  1.61598580



$generalized.weights
$generalized.weights[[1]]
           [,1]        [,2]
[1,]  486.93509  683.318372
[2,]  115.53349 -245.943366
[3,] -134.00267   64.741287
[4,]  -12.68865    2.833492


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]       [,3]
[1,] -1.1705292  0.5258020 -0.3239657
[2,]  0.3502307 -0.2269550  0.8430927
[3,]  0.4998103  0.3537628 -0.7722879

$startweights[[1]][[2]]
          [,1]
[1,] -1.654613
[2,] -0.662075
[3,] -1.525880
[4,] -1.141473



$result.matrix
                               [,1]
error                  0.0002511173
reached.threshold      0.0053481600
steps                 66.0000000000
Intercept.to.1layhid1 -0.9453595016
A.to.1layhid1         -3.6938464369
B.to.1layhid1          1.5470048615
Intercept.to.1layhid2 -0.7897018541
A.to.1layhid2         -3.4288496759
B.to.1layhid2         -4.0153143140
Intercept.to.1layhid3 -1.7213613647
A.to.1layhid3          2.3920522603
B.to.1layhid3         -5.7395441391
Intercept.to.OUT      -0.0631019639
1layhid1.to.OUT        1.6544360361
1layhid2.to.OUT       -2.0605410118
1layhid3.to.OUT        1.6159857995

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(xor_net, datatest)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] 0.001610854
[2,] 0.992074310
[3,] 0.989910767
[4,] 0.018303839
[5,] 0.989910767
[6,] 0.001610854</code></pre>
</div>
</div>
</section>
<section id="xor-hidden-4" class="level4">
<h4 class="anchored" data-anchor-id="xor-hidden-4">XOR: hidden = 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>xor_net <span class="ot">=</span> <span class="fu">neuralnet</span>(OUT<span class="sc">~</span>A<span class="sc">+</span>B,</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>                xor.data,</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hidden =</span> <span class="dv">4</span>,</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">stepmax =</span> <span class="fl">1e5</span>,</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rep =</span> <span class="dv">1</span>)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$call
neuralnet(formula = OUT ~ A + B, data = xor.data, hidden = 4, 
    stepmax = 1e+05, rep = 1)

$response
  OUT
1   0
2   1
3   1
4   0

$covariate
     A B
[1,] 0 0
[2,] 1 0
[3,] 0 1
[4,] 1 1

$model.list
$model.list$response
[1] "OUT"

$model.list$variables
[1] "A" "B"


$err.fct
function (x, y) 
{
    1/2 * (y - x)^2
}
&lt;bytecode: 0x000001ba21b32880&gt;
&lt;environment: 0x000001ba1fc7b7f0&gt;
attr(,"type")
[1] "sse"

$act.fct
function (x) 
{
    1/(1 + exp(-x))
}
&lt;bytecode: 0x000001ba21b35df0&gt;
&lt;environment: 0x000001ba1fc7bc88&gt;
attr(,"type")
[1] "logistic"

$linear.output
[1] TRUE

$data
  A B OUT
1 0 0   0
2 1 0   1
3 0 1   1
4 1 1   0

$exclude
NULL

$net.result
$net.result[[1]]
           [,1]
[1,] 0.01165566
[2,] 0.97061659
[3,] 0.99298029
[4,] 0.01557285


$weights
$weights[[1]]
$weights[[1]][[1]]
           [,1]       [,2]      [,3]        [,4]
[1,] -0.6184726 -0.8989921 -1.275248  0.04996336
[2,] -3.3877060 -7.1920874 -1.693141 -7.06178605
[3,]  1.3365677 -3.6258631  5.179611 -4.11629214

$weights[[1]][[2]]
           [,1]
[1,]  0.9997240
[2,]  1.8440334
[3,] -0.8594286
[4,] -1.2245045
[5,] -2.1810029



$generalized.weights
$generalized.weights[[1]]
              [,1]       [,2]
[1,]  351.67386680 205.033124
[2,]    0.08552639  -8.503865
[3,] -145.71224978  86.372695
[4,]  -12.63744258 -27.067665


$startweights
$startweights[[1]]
$startweights[[1]][[1]]
           [,1]       [,2]       [,3]       [,4]
[1,] -0.7798055 -0.9469387 -0.5622722 -0.0410526
[2,] -0.0170607  0.5763126  0.3842142  0.7066140
[3,]  0.9132254 -0.1303701  0.9131877 -0.7032992

$startweights[[1]][[2]]
            [,1]
[1,]  0.14316031
[2,] -0.05302307
[3,] -0.72401409
[4,] -0.24029997
[5,] -1.17843320



$result.matrix
                               [,1]
error                  0.0006455146
reached.threshold      0.0091746037
steps                 82.0000000000
Intercept.to.1layhid1 -0.6184725749
A.to.1layhid1         -3.3877060100
B.to.1layhid1          1.3365677076
Intercept.to.1layhid2 -0.8989921499
A.to.1layhid2         -7.1920874073
B.to.1layhid2         -3.6258630621
Intercept.to.1layhid3 -1.2752479972
A.to.1layhid3         -1.6931414346
B.to.1layhid3          5.1796106271
Intercept.to.1layhid4  0.0499633615
A.to.1layhid4         -7.0617860482
B.to.1layhid4         -4.1162921429
Intercept.to.OUT       0.9997239513
1layhid1.to.OUT        1.8440334058
1layhid2.to.OUT       -0.8594286389
1layhid3.to.OUT       -1.2245045337
1layhid4.to.OUT       -2.1810028955

attr(,"class")
[1] "nn"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xor_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>pred4 <span class="ot">=</span> <span class="fu">predict</span>(xor_net, datatest)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.01165566
[2,] 0.97061659
[3,] 0.99298029
[4,] 0.01557285
[5,] 0.99298029
[6,] 0.01165566</code></pre>
</div>
</div>
<p>Compare between hidden = 1,2,3 and 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>compare.xor <span class="ot">=</span> <span class="fu">data.frame</span>(A, B, actual, pred, pred1, pred2, pred3, pred4)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(compare.xor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"Actual"</span>, <span class="st">"OUT(0)"</span>, <span class="st">"OUT(1)"</span>, <span class="st">"OUT(2)"</span>, <span class="st">"OUT(3)"</span>, <span class="st">"OUT(4)"</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.xor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)     OUT(1)     OUT(2)      OUT(3)     OUT(4)
1 0 0      0 0.5078420 0.04007883 0.03955794 0.001610854 0.01165566
2 1 0      1 0.4974202 0.64932304 0.64285386 0.992074310 0.97061659
3 0 1      1 0.5063293 0.65018052 0.65178590 0.989910767 0.99298029
4 1 1      0 0.4959076 0.66813186 0.67507720 0.018303839 0.01557285
5 0 1      1 0.5063293 0.65018052 0.65178590 0.989910767 0.99298029
6 0 0      0 0.5078420 0.04007883 0.03955794 0.001610854 0.01165566</code></pre>
</div>
</div>
</section>
<section id="สรปผล" class="level4">
<h4 class="anchored" data-anchor-id="สรปผล">สรุปผล</h4>
<p>จากการ plot neuralnet model ด้านบนจะเห็นได้ว่ายิ่ง hidden layer มาก ความซับซ้อนของ model ก็ยิ่งมีมากตามไปด้วย ต่อไปจะทำการทดลองหาค่า error จากค่า actual เเละ prediction ด้วย RMSE</p>
<p>เขียน function คำนวณหาค่า RMSE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>calculate.rmse <span class="ot">=</span> <span class="cf">function</span>(y.actual, y.pred)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y.actual <span class="sc">-</span> y.pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rmse)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>คำนวณ RMSE ของ OR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)      OUT(1)     OUT(2)    OUT(3)     OUT(4)
1 0 0      0 0.2478835 -0.00518267 0.02510334 0.0157388 0.01088057
2 1 0      1 0.7522984  0.99053560 0.96097586 0.9661852 0.99005558
3 0 1      1 0.7439589  0.97460548 0.95492675 0.9646067 0.98370693
4 1 1      1 1.2483739  1.04189258 1.06221272 1.0622868 1.02440013
5 0 1      1 0.7439589  0.97460548 0.95492675 0.9646067 0.98370693
6 0 0      0 0.2478835 -0.00518267 0.02510334 0.0157388 0.01088057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>or.rmse0 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.or<span class="sc">$</span>Actual, compare.or<span class="sc">$</span><span class="st">`</span><span class="at">OUT(0)</span><span class="st">`</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>or.rmse1 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.or<span class="sc">$</span>Actual, compare.or<span class="sc">$</span><span class="st">`</span><span class="at">OUT(1)</span><span class="st">`</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>or.rmse2 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.or<span class="sc">$</span>Actual, compare.or<span class="sc">$</span><span class="st">`</span><span class="at">OUT(2)</span><span class="st">`</span>)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>or.rmse3 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.or<span class="sc">$</span>Actual, compare.or<span class="sc">$</span><span class="st">`</span><span class="at">OUT(3)</span><span class="st">`</span>)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>or.rmse4 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.or<span class="sc">$</span>Actual, compare.or<span class="sc">$</span><span class="st">`</span><span class="at">OUT(4)</span><span class="st">`</span>)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>rmse.or <span class="ot">=</span> <span class="fu">c</span>(or.rmse0,or.rmse1,or.rmse2,or.rmse3,or.rmse4)</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmse.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25068312 0.02305084 0.04226278 0.03656932 0.01560961</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse.or, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>คำนวณ RMSE ของ NOR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.nor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual     OUT(0)      OUT(1)      OUT(2)        OUT(3)       OUT(4)
1 0 0      1  0.7426990  1.00246621  0.97901577  0.9897716231  0.992389135
2 1 0      0  0.2501569  0.01745319  0.07448067 -0.0007248956  0.005861403
3 0 1      0  0.2486062  0.01790495  0.02418218  0.0207351759  0.010004380
4 1 1      0 -0.2439359 -0.03190816 -0.08750991 -0.0144633003 -0.015318621
5 0 1      0  0.2486062  0.01790495  0.02418218  0.0207351759  0.010004380
6 0 0      1  0.7426990  1.00246621  0.97901577  0.9897716231  0.992389135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>nor.rmse0 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nor<span class="sc">$</span>Actual, compare.nor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(0)</span><span class="st">`</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>nor.rmse1 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nor<span class="sc">$</span>Actual, compare.nor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(1)</span><span class="st">`</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>nor.rmse2 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nor<span class="sc">$</span>Actual, compare.nor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(2)</span><span class="st">`</span>)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>nor.rmse3 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nor<span class="sc">$</span>Actual, compare.nor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(3)</span><span class="st">`</span>)</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>nor.rmse4 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nor<span class="sc">$</span>Actual, compare.nor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(4)</span><span class="st">`</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>rmse.nor <span class="ot">=</span> <span class="fu">c</span>(nor.rmse0,nor.rmse1,nor.rmse2,nor.rmse3,nor.rmse4)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmse.nor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.251031504 0.018147927 0.050424181 0.014599355 0.009874563</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse.nor, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>คำนวณ RMSE ของ NAND</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.nand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)    OUT(1)     OUT(2)     OUT(3)     OUT(4)
1 0 0      1 1.2427502 0.7413312 1.06431898 1.01895758 1.00188348
2 1 0      1 0.7480254 0.7497864 0.98071974 0.99177415 0.98908795
3 0 1      1 0.7497326 0.7497323 0.92881016 0.98281331 0.97921854
4 1 1      0 0.2550078 0.7498027 0.02104608 0.01175725 0.02652307
5 0 1      1 0.7497326 0.7497323 0.92881016 0.98281331 0.97921854
6 0 0      1 1.2427502 0.7413312 1.06431898 1.01895758 1.00188348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>nand.rmse0 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nand<span class="sc">$</span>Actual, compare.nand<span class="sc">$</span><span class="st">`</span><span class="at">OUT(0)</span><span class="st">`</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>nand.rmse1 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nand<span class="sc">$</span>Actual, compare.nand<span class="sc">$</span><span class="st">`</span><span class="at">OUT(1)</span><span class="st">`</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>nand.rmse2 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nand<span class="sc">$</span>Actual, compare.nand<span class="sc">$</span><span class="st">`</span><span class="at">OUT(2)</span><span class="st">`</span>)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>nand.rmse3 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nand<span class="sc">$</span>Actual, compare.nand<span class="sc">$</span><span class="st">`</span><span class="at">OUT(3)</span><span class="st">`</span>)</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>nand.rmse4 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.nand<span class="sc">$</span>Actual, compare.nand<span class="sc">$</span><span class="st">`</span><span class="at">OUT(4)</span><span class="st">`</span>)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>rmse.nand <span class="ot">=</span> <span class="fu">c</span>(nand.rmse0,nand.rmse1,nand.rmse2,nand.rmse3,nand.rmse4)</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmse.nand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.24887850 0.38381809 0.05660464 0.01589257 0.01679970</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse.nand, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>คำนวณ RMSE ของ XOR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare.xor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B Actual    OUT(0)     OUT(1)     OUT(2)      OUT(3)     OUT(4)
1 0 0      0 0.5078420 0.04007883 0.03955794 0.001610854 0.01165566
2 1 0      1 0.4974202 0.64932304 0.64285386 0.992074310 0.97061659
3 0 1      1 0.5063293 0.65018052 0.65178590 0.989910767 0.99298029
4 1 1      0 0.4959076 0.66813186 0.67507720 0.018303839 0.01557285
5 0 1      1 0.5063293 0.65018052 0.65178590 0.989910767 0.99298029
6 0 0      0 0.5078420 0.04007883 0.03955794 0.001610854 0.01165566</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>xor.rmse0 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.xor<span class="sc">$</span>Actual, compare.xor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(0)</span><span class="st">`</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>xor.rmse1 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.xor<span class="sc">$</span>Actual, compare.xor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(1)</span><span class="st">`</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>xor.rmse2 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.xor<span class="sc">$</span>Actual, compare.xor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(2)</span><span class="st">`</span>)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>xor.rmse3 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.xor<span class="sc">$</span>Actual, compare.xor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(3)</span><span class="st">`</span>)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>xor.rmse4 <span class="ot">=</span> <span class="fu">calculate.rmse</span>(compare.xor<span class="sc">$</span>Actual, compare.xor<span class="sc">$</span><span class="st">`</span><span class="at">OUT(4)</span><span class="st">`</span>)</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>rmse.xor <span class="ot">=</span> <span class="fu">c</span>(xor.rmse0,xor.rmse1,xor.rmse2,xor.rmse3,xor.rmse4)</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmse.xor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.50028978 0.36908321 0.37168947 0.01005503 0.01568524</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse.xor, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>นำ RMSE มา plot เปรียบเทียบกันของทุก operator</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse.or, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(rmse.nor, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'black'</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(rmse.nand, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(rmse.xor, <span class="at">type=</span><span class="st">'o'</span>, <span class="at">col=</span><span class="st">'orange'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Neuralnet_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>จากกราฟแสดงให้เห็นว่า ยิ่ง hidden layer มีจำนวนมาก RMSR ก็ยิ่งมีแนวโน้มลดลง แต่ไม่สามารถสรุปได้ว่า hidden layer มากกว่าจะได้ RMSE น้อยกว่าเสมอ ดังที่เห็นจากกราฟ จุดที่ index ที่น้อยกว่าไม่ได้มีค่า RMSE มากกว่า index ถัดไปทุกจุด ดังนั้น การจะเลือกใช้ค่า hidden layer สามารถตัดสินใจได้จากการ plot กราฟได้ และไม่สามารถแก้ปัญหา XOR ได้เมื่อใช้ hidden layer 1 หรือ 2 เนื่องจากจะได้ error ที่สูงมาก</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>